---
title: "Mappe_1"
format: html
editor: visual
---

```{r, warning=FALSE}
rm(list=ls()) 
library(tidyverse)
library(rjstat)
library(httr)
options(scipen = 999)
```

Oppgave 1 - 40% Lag to til fire figurer som sammenligninger sysselsetting, produksjon, bruttoprodukt, og bruttoprodukt per sysselsatt på tvers av næringer i 2022. Sysselsetting oppgis i antall årsverk, produksjon, bruttoprodukt, og bruttoprodukt per sysselsatt i løpende priser. Dere må selv avgjøre hvilke tall som er meningsfylte å sammenligne og hvorvidt dere ønsker å dele opp tallene i ulike figurer.

```{r}
url <- 'https://data.ssb.no/api/v0/no/table/09171/'
  
query <- '{
  "query": [
    {
      "code": "NACE",
      "selection": {
        "filter": "item",
        "values": [
          "pub2X01_02",
          "pub2X03",
          "pub2X05",
          "nr2X06_09",
          "nr23ind",
          "pub2X35",
          "pub2X36_39",
          "pub2X41_43",
          "pub2X45_47",
          "pub2X49B",
          "pub2X50A",
          "pub2X49A_52",
          "pub2X53",
          "pub2X55_56",
          "pub2X58_63",
          "pub2X64_66",
          "pub2X68A",
          "pub2X68B",
          "pub2X69_75",
          "pub2X77_82",
          "pub2X84",
          "pub2X85",
          "pub2X86_88",
          "pub2X90_97",
          "nr23_6fn",
          "nr23mark",
          "nrimark"
        ]
      }
    },
    {
      "code": "ContentsCode",
      "selection": {
        "filter": "item",
        "values": [
          "Prob",
          "Pin",
          "BNPB",
          "BNPB2"
        ]
      }
    }
  ],
  "response": {
    "format": "json-stat2"
  }
}'

hent_indeks.tmp1 <- url %>%
  POST(body = query, encode = "json")

df <-  hent_indeks.tmp1 %>%
  content("text") %>%
  fromJSONstat() %>%
  as_tibble()
```

```{r}
url <- 'https://data.ssb.no/api/v0/no/table/08536/'
query <- '{
  "query": [
    {
      "code": "Region",
      "selection": {
        "filter": "vs:Landet",
        "values": [
          "0"
        ]
      }
    },
    {
      "code": "NACE2007",
      "selection": {
        "filter": "item",
        "values": [
          "00-99",
          "01",
          "02",
          "03",
          "05",
          "06",
          "07",
          "08",
          "09",
          "10",
          "11",
          "12",
          "13",
          "14",
          "15",
          "16",
          "17",
          "18",
          "19",
          "20",
          "21",
          "22",
          "23",
          "24",
          "25",
          "26",
          "27",
          "28",
          "29",
          "30",
          "31",
          "32",
          "33",
          "35",
          "36",
          "37",
          "38",
          "39",
          "41",
          "42",
          "43",
          "45",
          "46",
          "47",
          "49",
          "50",
          "51",
          "52",
          "53",
          "55",
          "56",
          "58",
          "59",
          "60",
          "61",
          "62",
          "63",
          "64",
          "65",
          "66",
          "68",
          "69",
          "70",
          "71",
          "72",
          "73",
          "74",
          "75",
          "77",
          "78",
          "79",
          "80",
          "81",
          "82",
          "84",
          "85",
          "86",
          "87",
          "88",
          "90",
          "91",
          "92",
          "93",
          "94",
          "95",
          "96",
          "97",
          "99",
          "00"
        ]
      }
    },
    {
      "code": "ContentsCode",
      "selection": {
        "filter": "item",
        "values": [
          "SysselArbsted"
        ]
      }
    },
    {
      "code": "Tid",
      "selection": {
        "filter": "item",
        "values": [
          "2012",
          "2013",
          "2014",
          "2015",
          "2016",
          "2017",
          "2018",
          "2019",
          "2020",
          "2021"
        ]
      }
    }
  ],
  "response": {
    "format": "json-stat2"
  }
}'

hent_indeks.tmp <- url %>%
  POST(body = query, encode = "json")

df_lol <-  hent_indeks.tmp %>%
  content("text") %>%
  fromJSONstat() %>%
  as_tibble()
```

Oppgave 2 - 10% Diskuter hvorvidt bruttoprodukt per sysselsatt er et godt mål på produktivitet i offentlig sektor.

Verdiskaping og opptjent bruttoinntekt fra innenlandsk produksjonsaktivitet i en næring eller sektor og definert som produksjon minus produktinnsats. I motsetning til markedsrettet produksjon, blir bruttoproduktet i offentlig forvaltning konvensjonelt beregnet fra kostnadssiden, uten å inkludere kapitalavkastning. Det medfører at bruttoprodukt per sysselsatt i offentlig tjenesteyting definisjonsmessig verdsettes lavere enn i markedsrettet virksomhet.

privat sektor = konkurranse

offentlig sektor = goder til befolkningen

```{r}
library(lubridate)
library(dplyr)


df2 <- df %>%
separate(kvartal, 
         into=c("year"), 
         sep="K") %>% 
  mutate(year = (year)) %>% 
  rename(var = statistikkvariabel)

df2 <- df2 %>% 
  group_by(year, næring, var) %>% 
  summarise(verdi = sum(value))
```

```{r}
df3 <- df2 %>% 
  filter(var != 'Produksjon i basisverdi. Løpende priser (mill. kr)') %>% 
  filter(var != 'Produktinnsats. Løpende priser (mill. kr)') %>% 
  filter(var != 'Bruttoprodukt i basisverdi. Faste 2020-priser (mill. kr)') %>% 
  filter(year >= 2011)
df3 %>%
  ggplot(aes(x = year, y = verdi, color = næring, group = næring))+
  geom_line()+
  theme(legend.position = "bottom")
  

df4 <- df2 %>% 
  filter(var != 'Produksjon i basisverdi. Løpende priser (mill. kr)') %>% 
  filter(var != 'Produktinnsats. Løpende priser (mill. kr)') %>% 
  filter(var != 'Bruttoprodukt i basisverdi. Løpende priser (mill. kr)') %>% 
  filter(year >= 2011)
df4 %>% 
  ggplot(aes(x = year, y = verdi, color = næring, group = næring))+
  geom_line()+
  theme(legend.position = "bottom")
```

Oppgave 3 - 40% Lag figurer som viser bruttoprodukt per næring i både faste og løpende priser mellom 2012 og 2022. Diskuter hvorvidt det er noen næringer hvor variasjon i produktprisene har særlig stor innvirkning på verdien av bruttoproduksjonen.

```{r}

```

Oppgave 4 - 10% I norsk sammenheng skiller vi ofte mellom brutto nasjonal produkt (BNP) og brutto nasjonalprodukt på fastlandet (FN-BNP). Hvilke næringer er unntatt fra FN-BNP, og hvorfor gjøres dette? Knytt gjerne besvarelsen til funnene fra oppgave 3.

```{r}

```
